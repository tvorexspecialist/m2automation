<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="../../../../../../vendor/magento/magento2-functional-testing-framework/src/Magento/FunctionalTestingFramework/Test/etc/testSchema.xsd">
    <test name="EndToEndB2CUserCest">
        <annotations>
            <features value="End to End scenarios"/>
            <stories value="End-to-end automation: B2C guest user - MAGETWO-75411"/>
            <group value="e2e"/>
            <title value="You should be able to pass End to End B2C Guest User scenario"/>
            <description value="User browses catalog, searches for product, adds product to cart, adds product to wishlist, compares products, uses coupon code and checks out."/>
            <severity value="CRITICAL"/>
            <testCaseId value="MAGETWO-87435"/>
        </annotations>
        <before>
            <resetCookie userInput="PHPSESSID" stepKey="resetCookieForCart"/>

            <createData entity="ApiCategory" stepKey="createCategory"/>

            <createData entity="ApiSimpleProduct" stepKey="createSimpleProduct1">
                <requiredEntity createDataKey="createCategory"/>
            </createData>
            <createData entity="ApiProductAttributeMediaGalleryEntryTestImage" stepKey="createSimpleProduct1Image">
                <requiredEntity createDataKey="createSimpleProduct1"/>
            </createData>
            <createData entity="ApiProductAttributeMediaGalleryEntryMagentoLogo" stepKey="createSimpleProduct1Image1">
                <requiredEntity createDataKey="createSimpleProduct1"/>
            </createData>
            <updateData entity="ApiSimpleProductUpdateDescription" stepKey="updateSimpleProduct1" createDataKey="createSimpleProduct1"/>

            <createData entity="ApiSimpleProduct" stepKey="createSimpleProduct2">
                <requiredEntity createDataKey="createCategory"/>
            </createData>
            <createData entity="ApiProductAttributeMediaGalleryEntryTestImage" stepKey="createSimpleProduct2Image">
                <requiredEntity createDataKey="createSimpleProduct2"/>
            </createData>
            <updateData entity="ApiSimpleProductUpdateDescription" stepKey="updateSimpleProduct2" createDataKey="createSimpleProduct2"/>

            <createData entity="ApiCategory" stepKey="createCategory1"/>
            <createData entity="ApiSimpleProduct" stepKey="createSimpleProduct3">
                <requiredEntity createDataKey="createCategory1"/>
            </createData>

            <!-- @TODO: MAGETWO-80272 Move to Configurable -->
            <createData entity="ApiConfigurableProduct" stepKey="createConfigProduct">
                <requiredEntity createDataKey="createCategory"/>
            </createData>
            <createData entity="productAttributeWithTwoOptions" stepKey="createConfigProductAttribute"/>
            <createData entity="productAttributeOption1" stepKey="createConfigProductAttributeOption1">
                <requiredEntity createDataKey="createConfigProductAttribute"/>
            </createData>
            <createData entity="productAttributeOption2" stepKey="createConfigProductAttributeOption2">
                <requiredEntity createDataKey="createConfigProductAttribute"/>
            </createData>
            <createData entity="AddToDefaultSet" stepKey="createConfigAddToAttributeSet">
                <requiredEntity createDataKey="createConfigProductAttribute"/>
            </createData>
            <getData entity="ProductAttributeOptionGetter" index="1" stepKey="getConfigAttributeOption1">
                <requiredEntity createDataKey="createConfigProductAttribute"/>
            </getData>
            <getData entity="ProductAttributeOptionGetter" index="2" stepKey="getConfigAttributeOption2">
                <requiredEntity createDataKey="createConfigProductAttribute"/>
            </getData>
            <createData entity="ApiSimpleOne" stepKey="createConfigChildProduct1">
                <requiredEntity createDataKey="createConfigProductAttribute"/>
                <requiredEntity createDataKey="getConfigAttributeOption1"/>
            </createData>
            <createData entity="ApiProductAttributeMediaGalleryEntryTestImage" stepKey="createConfigChildProduct1Image">
                <requiredEntity createDataKey="createConfigChildProduct1"/>
            </createData>
            <createData entity="ApiSimpleTwo" stepKey="createConfigChildProduct2">
                <requiredEntity createDataKey="createConfigProductAttribute"/>
                <requiredEntity createDataKey="getConfigAttributeOption2"/>
            </createData>
            <createData entity="ApiProductAttributeMediaGalleryEntryMagentoLogo" stepKey="createConfigChildProduct2Image">
                <requiredEntity createDataKey="createConfigChildProduct2"/>
            </createData>
            <createData entity="ConfigurableProductTwoOptions" stepKey="createConfigProductOption">
                <requiredEntity createDataKey="createConfigProduct"/>
                <requiredEntity createDataKey="createConfigProductAttribute"/>
                <requiredEntity createDataKey="getConfigAttributeOption1"/>
                <requiredEntity createDataKey="getConfigAttributeOption2"/>
            </createData>
            <createData entity="ConfigurableProductAddChild" stepKey="createConfigProductAddChild1">
                <requiredEntity createDataKey="createConfigChildProduct1"/>
                <requiredEntity createDataKey="createConfigProduct"/>
            </createData>
            <createData entity="ConfigurableProductAddChild" stepKey="createConfigProductAddChild2">
                <requiredEntity createDataKey="createConfigChildProduct2"/>
                <requiredEntity createDataKey="createConfigProduct"/>
            </createData>
            <createData entity="ApiProductAttributeMediaGalleryEntryTestImage" stepKey="createConfigProductImage">
                <requiredEntity createDataKey="createConfigProduct"/>
            </createData>
            <updateData entity="ApiSimpleProductUpdateDescription" stepKey="updateConfigProduct" createDataKey="createConfigProduct"/>

            <!-- @TODO: MAGETWO-80272 Move to SalesRule -->
            <createData entity="ApiSalesRule" stepKey="createSalesRule"/>
            <createData entity="ApiSalesRuleCoupon" stepKey="createSalesRuleCoupon">
                <requiredEntity createDataKey="createSalesRule"/>
            </createData>
        </before>
        <after>
            <deleteData createDataKey="createCategory" stepKey="deleteCategory"/>
            <deleteData createDataKey="createCategory1" stepKey="deleteCategory1"/>

            <!-- @TODO: Uncomment once MQE-679 is fixed -->
            <!--<deleteData createDataKey="createSimpleProduct1Image" stepKey="deleteSimpleProduct1Image"/>-->
            <!-- @TODO: Uncomment once MQE-679 is fixed -->
            <!--<deleteData createDataKey="createSimpleProduct1Image1" stepKey="deleteSimpleProduct1Image1"/>-->
            <deleteData createDataKey="createSimpleProduct1" stepKey="deleteSimpleProduct1"/>

            <!-- @TODO: Uncomment once MQE-679 is fixed -->
            <!--<deleteData createDataKey="createSimpleProduct2Image" stepKey="deleteSimpleProduct2Image"/>-->
            <deleteData createDataKey="createSimpleProduct2" stepKey="deleteSimpleProduct2"/>
            <deleteData createDataKey="createSimpleProduct3" stepKey="deleteSimpleProduct3"/>

            <!-- @TODO: MAGETWO-80272 Move to Configurable -->
            <!-- @TODO: Uncomment once MQE-679 is fixed -->
            <!--<deleteData createDataKey="createConfigChildProduct1Image" stepKey="deleteConfigChildProduct1Image"/>-->
            <deleteData createDataKey="createConfigChildProduct1" stepKey="deleteConfigChildProduct1"/>
            <!-- @TODO: Uncomment once MQE-679 is fixed -->
            <!--<deleteData createDataKey="createConfigChildProduct2Image" stepKey="deleteConfigChildProduct2Image"/>-->
            <deleteData createDataKey="createConfigChildProduct2" stepKey="deleteConfigChildProduct2"/>
            <!-- @TODO: Uncomment once MQE-679 is fixed -->
            <!--<deleteData createDataKey="createConfigProductImage" stepKey="deleteConfigProductImage"/>-->
            <deleteData createDataKey="createConfigProduct" stepKey="deleteConfigProduct"/>
            <deleteData createDataKey="createConfigProductAttribute" stepKey="deleteConfigProductAttribute"/>

            <!-- @TODO: MAGETWO-80272 Move to SalesRule -->
            <deleteData createDataKey="createSalesRule" stepKey="deleteSalesRule"/>
        </after>

        <!-- Step 1: User browses catalog -->
        <amOnPage url="{{StorefrontHomePage}}" stepKey="amOnHomePage"/>
        <waitForPageLoad stepKey="homeWaitForPageLoad"/>
        <waitForElementVisible selector="{{StorefrontPanelHeaderSection.WelcomeMessage}}" stepKey="homeWaitForWelcomeMessage"/>
        <see userInput="Default welcome msg!" selector="{{StorefrontPanelHeaderSection.WelcomeMessage}}" stepKey="homeCheckWelcome"/>

        <!-- Open Category -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="browseClickCategory"/>
        <actionGroup ref="StorefrontCheckCategoryActionGroup" stepKey="browseAssertCategory">
            <argument name="category" value="$$createCategory$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.three"/>
        </actionGroup>
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="browseAssertCategoryProduct1">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct1.name$$)}}" userInput="src" stepKey="browseGrabSimpleProduct1ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$browseGrabSimpleProduct1ImageSrc" stepKey="browseAssertSimpleProduct1ImageNotDefault"/>
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="browseAssertCategoryProduct2">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct2.name$$)}}" userInput="src" stepKey="browseGrabSimpleProduct2ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$browseGrabSimpleProduct2ImageSrc" stepKey="browseAssertSimpleProduct2ImageNotDefault"/>
        <!-- Check more products -->
        <comment userInput="Check more products" stepKey="checkMoreProducts" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <actionGroup ref="StorefrontCheckCategoryConfigurableProduct" stepKey="browseAssertCategoryConfigProduct" after="checkMoreProducts">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createConfigProduct.name$$)}}" userInput="src" stepKey="browseGrabConfigProductImageSrc" after="browseAssertCategoryConfigProduct"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$browseGrabConfigProductImageSrc" stepKey="browseAssertConfigProductImageNotDefault" after="browseGrabConfigProductImageSrc"/>

        <!-- View Simple Product 1 -->
        <click selector="{{StorefrontCategoryProductSection.ProductTitleByName($$createSimpleProduct1.name$$)}}" stepKey="browseClickCategorySimpleProduct1View"/>
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="browseAssertProduct1Page">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="browseGrabSimpleProduct1PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$browseGrabSimpleProduct1PageImageSrc" stepKey="browseAssertSimpleProduct1PageImageNotDefault"/>

        <!-- View Simple Product 2 -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="clickCategory1"/>
        <click selector="{{StorefrontCategoryProductSection.ProductTitleByName($$createSimpleProduct2.name$$)}}" stepKey="browseClickCategorySimpleProduct2View"/>
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="browseAssertProduct2Page">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="browseGrabSimpleProduct2PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$browseGrabSimpleProduct2PageImageSrc" stepKey="browseAssertSimpleProduct2PageImageNotDefault"/>

        <!-- View more products -->
        <comment userInput="View more products" stepKey="viewMoreProducts" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <!-- View Configurable Product -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="clickCategory2" after="viewMoreProducts"/>
        <click selector="{{StorefrontCategoryProductSection.ProductTitleByName($$createConfigProduct.name$$)}}" stepKey="browseClickCategoryConfigProductView" after="clickCategory2"/>
        <actionGroup ref="StorefrontCheckConfigurableProduct" stepKey="browseAssertConfigProductPage" after="browseClickCategoryConfigProductView">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="browseGrabConfigProductPageImageSrc" after="browseAssertConfigProductPage"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$browseGrabConfigProductPageImageSrc" stepKey="browseAssertConfigProductPageImageNotDefault" after="browseGrabConfigProductPageImageSrc"/>

        <!-- @TODO: MAGETWO-80272 Move to CatalogSearch -->
        <!-- Step 2: User searches for product -->
        <!-- Advanced Search with Product 1 Data -->
        <actionGroup ref="StorefrontOpenAdvancedSearchActionGroup" stepKey="searchOpenAdvancedSearchForm"/>
        <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
        <fillField userInput="$$createSimpleProduct1.name$$" selector="{{StorefrontCatalogSearchAdvancedFormSection.ProductName}}" stepKey="searchAdvancedFillProductName"/>
        <fillField userInput="$$createSimpleProduct1.sku$$" selector="{{StorefrontCatalogSearchAdvancedFormSection.SKU}}" stepKey="searchAdvancedFillSKU"/>
        <fillField userInput="$$createSimpleProduct1.price$$" selector="{{StorefrontCatalogSearchAdvancedFormSection.PriceFrom}}" stepKey="searchAdvancedFillPriceFrom"/>
        <fillField userInput="$$createSimpleProduct1.price$$" selector="{{StorefrontCatalogSearchAdvancedFormSection.PriceTo}}" stepKey="searchAdvancedFillPriceTo"/>
        <click selector="{{StorefrontCatalogSearchAdvancedFormSection.SubmitButton}}" stepKey="searchClickAdvancedSearchSubmitButton"/>
        <actionGroup ref="StorefrontCheckAdvancedSearchResultActionGroup" stepKey="searchCheckAdvancedSearchResult"/>
        <see userInput="1" selector="{{StorefrontCatalogSearchAdvancedResultMainSection.productCount}} span" stepKey="searchAdvancedAssertProductCount"/>
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="searchAssertSimpleProduct1">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct1.name$$)}}" userInput="src" stepKey="searchAdvancedGrabSimpleProduct1ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$searchAdvancedGrabSimpleProduct1ImageSrc" stepKey="searchAdvancedAssertSimpleProduct1ImageNotDefault"/>
        <click selector="{{StorefrontCategoryProductSection.ProductTitleByName($$createSimpleProduct1.name$$)}}" stepKey="searchClickSimpleProduct1View"/>
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="searchAssertSimpleProduct1Page">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="searchAdvancedGrabSimpleProduct1PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$searchAdvancedGrabSimpleProduct1PageImageSrc" stepKey="searchAdvancedAssertSimpleProduct1PageImageNotDefault"/>

        <!-- Quick Search with common part of product names -->
        <actionGroup ref="StorefrontCheckQuickSearchActionGroup" stepKey="searchQuickSearchCommonPart">
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="phrase" value="CONST.apiSimpleProduct"/>
        </actionGroup>
        <actionGroup ref="StorefrontSelectSearchFilterCategoryActionGroup" stepKey="searchSelectFilterCategoryCommonPart">
            <argument name="category" value="$$createCategory$$"/>
        </actionGroup>
        <see userInput="3" selector="{{StorefrontCategoryMainSection.productCount}} span" stepKey="searchAssertFilterCategoryProductCountCommonPart"/>

        <!-- Search products -->
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="searchAssertFilterCategorySimpleProduct1">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct1.name$$)}}" userInput="src" stepKey="searchGrabSimpleProduct1ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$searchGrabSimpleProduct1ImageSrc" stepKey="searchAssertSimpleProduct1ImageNotDefault"/>
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="searchAssertFilterCategorySimpleProduct2">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct2.name$$)}}" userInput="src" stepKey="searchGrabSimpleProduct2ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$searchGrabSimpleProduct2ImageSrc" stepKey="searchAssertSimpleProduct2ImageNotDefault"/>

        <comment userInput="Search more products" stepKey="searchMoreProducts" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <actionGroup ref="StorefrontCheckCategoryConfigurableProduct" stepKey="searchAssertFilterCategoryConfigProduct" after="searchMoreProducts">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createConfigProduct.name$$)}}" userInput="src" stepKey="searchGrabConfigProductImageSrc" after="searchAssertFilterCategoryConfigProduct"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$searchGrabConfigProductImageSrc" stepKey="searchAssertConfigProductImageNotDefault" after="searchGrabConfigProductImageSrc"/>
        <click selector="{{StorefrontCategoryProductSection.ProductTitleByName($$createConfigProduct.name$$)}}" stepKey="searchClickConfigProductView" after="searchAssertConfigProductImageNotDefault"/>
        <actionGroup ref="StorefrontCheckConfigurableProduct" stepKey="searchAssertConfigProductPage" after="searchClickConfigProductView">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="searchGrabConfigProductPageImageSrc" after="searchAssertConfigProductPage"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$searchGrabConfigProductPageImageSrc" stepKey="searchAssertConfigProductPageImageNotDefault" after="searchGrabConfigProductPageImageSrc"/>

        <!-- Quick Search with non-existent product name -->
        <actionGroup ref="StorefrontCheckQuickSearchActionGroup" stepKey="searchFillQuickSearchNonExistent">
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="phrase" value="CONST.nonexistentProductName"/>
        </actionGroup>
        <see userInput="Your search returned no results." selector="{{StorefrontCatalogSearchMainSection.message}}" stepKey="searchAssertQuickSearchMessageNonExistent"/>

        <!-- @TODO: MAGETWO-80272 Move to Checkout -->
        <!-- Step 3: User adds products to cart -->
        <!-- Add Simple Product 1 to cart -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="cartClickCategory"/>
        <actionGroup ref="StorefrontCheckCategoryActionGroup" stepKey="cartAssertCategory">
            <argument name="category" value="$$createCategory$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.three"/>
        </actionGroup>
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="cartAssertSimpleProduct1">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct1.name$$)}}" userInput="src" stepKey="cartGrabSimpleProduct1ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$cartGrabSimpleProduct1ImageSrc" stepKey="cartAssertSimpleProduct1ImageNotDefault"/>
        <click selector="{{StorefrontCategoryProductSection.ProductTitleByName($$createSimpleProduct1.name$$)}}" stepKey="cartClickSimpleProduct1"/>
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="cartAssertProduct1Page">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartGrabSimpleProduct1PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartGrabSimpleProduct1PageImageSrc" stepKey="cartAssertSimpleProduct1PageImageNotDefault"/>
        <actionGroup ref="StorefrontAddProductToCartActionGroup" stepKey="cartAddProduct1ToCart">
            <argument name="product" value="$$createSimpleProduct1$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.one"/>
        </actionGroup>

        <!-- Add Simple Product 2 to cart -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="cartClickCategory1"/>
        <actionGroup ref="StorefrontCheckCategoryActionGroup" stepKey="cartAssertCategory1">
            <argument name="category" value="$$createCategory$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.three"/>
        </actionGroup>
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="cartAssertSimpleProduct2">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct2.name$$)}}" userInput="src" stepKey="cartGrabSimpleProduct2ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$cartGrabSimpleProduct2ImageSrc" stepKey="cartAssertSimpleProduct2ImageNotDefault"/>
        <actionGroup ref="StorefrontAddCategoryProductToCartActionGroup" stepKey="cartAddProduct2ToCart">
            <argument name="product" value="$$createSimpleProduct2$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.two"/>
        </actionGroup>

        <comment userInput="Add more products to cart" stepKey="addMoreProductsToCart" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <!-- Add Configurable Product to cart -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="cartClickCategory2"/>
        <actionGroup ref="StorefrontCheckCategoryActionGroup" stepKey="cartAssertCategory1">
            <argument name="category" value="$$createCategory$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.three"/>
        </actionGroup>
        <actionGroup ref="StorefrontCheckCategoryConfigurableProduct" stepKey="cartAssertConfigProduct">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createConfigProduct.name$$)}}" userInput="src" stepKey="cartGrabConfigProductImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$cartGrabConfigProductImageSrc" stepKey="cartAssertConfigProductImageNotDefault"/>
        <click selector="{{StorefrontCategoryProductSection.ProductAddToCartByName($$createConfigProduct.name$$)}}" stepKey="cartClickCategoryConfigProductAddToCart"/>
        <waitForElement selector="{{StorefrontMessagesSection.message('You need to choose options for your item.')}}" time="30" stepKey="cartWaitForConfigProductPageLoad"/>
        <actionGroup ref="StorefrontCheckConfigurableProduct" stepKey="cartAssertConfigProductPage">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartGrabConfigProductPageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartGrabConfigProductPageImageSrc" stepKey="cartAssertConfigProductPageImageNotDefault"/>
        <selectOption userInput="$$createConfigProductAttributeOption2.option[store_labels][1][label]$$" selector="{{StorefrontProductInfoMainSection.optionByAttributeId($$createConfigProductAttribute.attribute_id$$)}}" stepKey="cartConfigProductFillOption"/>
        <actionGroup ref="StorefrontCheckConfigurableProduct" stepKey="cartAssertConfigProductWithOptionPage">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartGrabConfigProductPageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartGrabConfigProductPageImageSrc" stepKey="cartAssertConfigProductPageImageNotDefault"/>
        <actionGroup ref="StorefrontAddProductToCartActionGroup" stepKey="cartAddConfigProductToCart">
            <argument name="product" value="$$createConfigProduct$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.three"/>
        </actionGroup>

        <!-- Check products in minicart -->
        <actionGroup ref="StorefrontOpenMinicartAndCheckSimpleProductActionGroup" stepKey="cartOpenMinicartAndCheckSimpleProduct1">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontMinicartSection.productImageByName($$createSimpleProduct1.name$$)}}" userInput="src" stepKey="cartMinicartGrabSimpleProduct1ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/thumbnail\.jpg/'" actual="$cartMinicartGrabSimpleProduct1ImageSrc" stepKey="cartMinicartAssertSimpleProduct1ImageNotDefault"/>
        <click selector="{{StorefrontMinicartSection.productLinkByName($$createSimpleProduct1.name$$)}}" stepKey="cartMinicartClickSimpleProduct1" />
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="cartAssertMinicartProduct1Page">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartMinicartGrabSimpleProduct1PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartMinicartGrabSimpleProduct1PageImageSrc" stepKey="cartMinicartAssertSimpleProduct1PageImageNotDefault"/>
        <actionGroup ref="StorefrontOpenMinicartAndCheckSimpleProductActionGroup" stepKey="cartOpenMinicartAndCheckSimpleProduct2">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontMinicartSection.productImageByName($$createSimpleProduct2.name$$)}}" userInput="src" stepKey="cartMinicartGrabSimpleProduct2ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/thumbnail\.jpg/'" actual="$cartMinicartGrabSimpleProduct2ImageSrc" stepKey="cartMinicartAssertSimpleProduct2ImageNotDefault"/>
        <click selector="{{StorefrontMinicartSection.productLinkByName($$createSimpleProduct2.name$$)}}" stepKey="cartMinicartClickSimpleProduct2" />
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="cartAssertMinicartProduct2Page">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartMinicartGrabSimpleProduct2PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartMinicartGrabSimpleProduct2PageImageSrc" stepKey="cartMinicartAssertSimpleProduct2PageImageNotDefault"/>

        <comment userInput="Check more products in minicart" stepKey="checkMoreProductsInMinicart" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <actionGroup ref="StorefrontOpenMinicartAndCheckConfigurableProductActionGroup" stepKey="cartOpenMinicartAndCheckConfigProduct" after="checkMoreProductsInMinicart">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontMinicartSection.productImageByName($$createConfigProduct.name$$)}}" userInput="src" stepKey="cartMinicartGrabConfigProductImageSrc" after="cartOpenMinicartAndCheckConfigProduct"/>
        <assertNotRegExp expected="'/placeholder\/thumbnail\.jpg/'" actual="$cartMinicartGrabConfigProductImageSrc" stepKey="cartMinicartAssertConfigProductImageNotDefault" after="cartMinicartGrabConfigProductImageSrc"/>
        <click selector="{{StorefrontMinicartSection.productOptionsDetailsByName($$createConfigProduct.name$$)}}" stepKey="cartMinicartClickConfigProductDetails" after="cartMinicartAssertConfigProductImageNotDefault"/>
        <see userInput="$$createConfigProductAttributeOption2.option[store_labels][1][label]$$" selector="{{StorefrontMinicartSection.productOptionByNameAndAttribute($$createConfigProduct.name$$, $$createConfigProductAttribute.attribute[frontend_labels][0][label]$$)}}" stepKey="cartMinicartCheckConfigProductOption" after="cartMinicartClickConfigProductDetails"/>
        <click selector="{{StorefrontMinicartSection.productLinkByName($$createConfigProduct.name$$)}}" stepKey="cartMinicartClickConfigProduct" after="cartMinicartCheckConfigProductOption"/>
        <actionGroup ref="StorefrontCheckConfigurableProduct" stepKey="cartAssertMinicartConfigProductPage" after="cartMinicartClickConfigProduct">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartMinicartGrabConfigProductPageImageSrc" after="cartAssertMinicartConfigProductPage"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartMinicartGrabConfigProductPageImageSrc" stepKey="cartMinicartAssertConfigProductPageImageNotDefault" after="cartMinicartGrabConfigProductPageImageSrc"/>

        <!-- Check products in cart -->
        <actionGroup ref="StorefrontOpenCartFromMinicartActionGroup" stepKey="cartOpenCart"/>
        <actionGroup ref="StorefrontCheckCartActionGroup" stepKey="cartAssertCart">
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="subtotal" value="E2EB2CQuote.subtotal"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="shipping" value="E2EB2CQuote.shipping"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="shippingMethod" value="E2EB2CQuote.shippingMethod"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="total" value="E2EB2CQuote.total"/>
        </actionGroup>

        <actionGroup ref="StorefrontCheckCartSimpleProductActionGroup" stepKey="cartAssertCartSimpleProduct1">
            <argument name="product" value="$$createSimpleProduct1$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productQuantity" value="CONST.one"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{CheckoutCartProductSection.ProductImageByName($$createSimpleProduct1.name$$)}}" userInput="src" stepKey="cartCartGrabSimpleProduct1ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$cartCartGrabSimpleProduct1ImageSrc" stepKey="cartCartAssertSimpleProduct1ImageNotDefault"/>
        <click selector="{{CheckoutCartProductSection.ProductLinkByName($$createSimpleProduct1.name$$)}}" stepKey="cartClickCartSimpleProduct1" />
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="cartAssertCartProduct1Page">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartCartGrabSimpleProduct2PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartCartGrabSimpleProduct2PageImageSrc" stepKey="cartCartAssertSimpleProduct2PageImageNotDefault"/>

        <actionGroup ref="StorefrontOpenCartFromMinicartActionGroup" stepKey="cartOpenCart1"/>
        <actionGroup ref="StorefrontCheckCartSimpleProductActionGroup" stepKey="cartAssertCartSimpleProduct2">
            <argument name="product" value="$$createSimpleProduct2$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productQuantity" value="CONST.one"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{CheckoutCartProductSection.ProductImageByName($$createSimpleProduct2.name$$)}}" userInput="src" stepKey="cartCartGrabSimpleProduct2ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$cartCartGrabSimpleProduct2ImageSrc" stepKey="cartCartAssertSimpleProduct2ImageNotDefault"/>
        <click selector="{{CheckoutCartProductSection.ProductLinkByName($$createSimpleProduct2.name$$)}}" stepKey="cartClickCartSimpleProduct2" />
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="cartAssertCartProduct2Page">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartCartGrabSimpleProduct2PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartCartGrabSimpleProduct2PageImageSrc" stepKey="cartCartAssertSimpleProduct2PageImageNotDefault"/>

        <comment userInput="Check more products in cart" stepKey="checkMoreProductsInCart" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <actionGroup ref="StorefrontOpenCartFromMinicartActionGroup" stepKey="cartOpenCart2" after="checkMoreProductsInCart"/>
        <actionGroup ref="StorefrontCheckCartConfigurableProductActionGroup" stepKey="cartAssertCartConfigProduct" after="cartOpenCart2">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct2$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productQuantity" value="CONST.one"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{CheckoutCartProductSection.ProductImageByName($$createConfigProduct.name$$)}}" userInput="src" stepKey="cartCartGrabConfigProduct2ImageSrc" after="cartAssertCartConfigProduct"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$cartCartGrabConfigProduct2ImageSrc" stepKey="cartCartAssertConfigProduct2ImageNotDefault" after="cartCartGrabConfigProduct2ImageSrc"/>
        <see userInput="$$createConfigProductAttributeOption2.option[store_labels][1][label]$$" selector="{{CheckoutCartProductSection.ProductOptionByNameAndAttribute($$createConfigProduct.name$$, $$createConfigProductAttribute.attribute[frontend_labels][0][label]$$)}}" stepKey="cartCheckConfigProductOption" after="cartCartAssertConfigProduct2ImageNotDefault"/>
        <click selector="{{CheckoutCartProductSection.ProductLinkByName($$createConfigProduct.name$$)}}" stepKey="cartClickCartConfigProduct" after="cartCheckConfigProductOption"/>
        <actionGroup ref="StorefrontCheckConfigurableProduct" stepKey="cartAssertCartConfigProductPage" after="cartClickCartConfigProduct">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="cartCartGrabConfigProductPageImageSrc" after="cartAssertCartConfigProductPage"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$cartCartGrabConfigProductPageImageSrc" stepKey="cartCartAssertConfigProductPageImageNotDefault" after="cartCartGrabConfigProductPageImageSrc"/>

        <!-- Step 4: User compares products -->
        <!-- Add Simple Product 1 to comparison -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="compareClickCategory"/>
        <actionGroup ref="StorefrontCheckCategoryActionGroup" stepKey="compareAssertCategory">
            <argument name="category" value="$$createCategory$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.three"/>
        </actionGroup>
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="compareAssertSimpleProduct1">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct1.name$$)}}" userInput="src" stepKey="compareGrabSimpleProduct1ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$compareGrabSimpleProduct1ImageSrc" stepKey="compareAssertSimpleProduct1ImageNotDefault"/>
        <click selector="{{StorefrontCategoryProductSection.ProductTitleByName($$createSimpleProduct1.name$$)}}" stepKey="compareClickSimpleProduct1"/>
        <actionGroup ref="StorefrontCheckSimpleProduct" stepKey="compareAssertProduct1Page">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductInfoMainSection.productImage}}" userInput="src" stepKey="compareGrabSimpleProduct1PageImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/image\.jpg/'" actual="$compareGrabSimpleProduct1PageImageSrc" stepKey="compareAssertSimpleProduct2PageImageNotDefault"/>
        <actionGroup ref="StorefrontAddProductToCompareActionGroup" stepKey="compareAddSimpleProduct1ToCompare">
            <argument name="product" value="$$createSimpleProduct1$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.one"/>
        </actionGroup>

        <!-- Add Simple Product 2 to comparison -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="compareClickCategory1"/>
        <actionGroup ref="StorefrontCheckCategoryActionGroup" stepKey="compareAssertCategory1">
            <argument name="category" value="$$createCategory$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.three"/>
        </actionGroup>
        <actionGroup ref="StorefrontCheckCategorySimpleProduct" stepKey="compareAssertSimpleProduct2">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createSimpleProduct2.name$$)}}" userInput="src" stepKey="compareGrabSimpleProduct2ImageSrc"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$compareGrabSimpleProduct2ImageSrc" stepKey="compareAssertSimpleProduct2ImageNotDefault"/>
        <actionGroup ref="StorefrontAddCategoryProductToCompareActionGroup" stepKey="compareAddSimpleProduct2ToCompare">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>

        <comment userInput="Add more products to comparision" stepKey="addMoreProductsToComparison" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <!-- Add Configurable Product to comparison -->
        <actionGroup ref="StorefrontCheckCategoryConfigurableProduct" stepKey="compareAssertConfigProduct" after="addMoreProductsToComparison">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontCategoryProductSection.ProductImageByName($$createConfigProduct.name$$)}}" userInput="src" stepKey="compareGrabConfigProductImageSrc" after="compareAssertConfigProduct"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$compareGrabConfigProductImageSrc" stepKey="compareAssertConfigProductImageNotDefault" after="compareGrabConfigProductImageSrc"/>
        <actionGroup ref="StorefrontAddCategoryProductToCompareActionGroup" stepKey="compareAddConfigProductToCompare" after="compareAssertConfigProductImageNotDefault">
            <argument name="product" value="$$createConfigProduct$$"/>
        </actionGroup>

        <!-- Check products in comparison sidebar -->
        <actionGroup ref="StorefrontCheckCompareSidebarProductActionGroup" stepKey="compareSimpleProduct1InSidebar">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <actionGroup ref="StorefrontCheckCompareSidebarProductActionGroup" stepKey="compareSimpleProduct2InSidebar">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <comment userInput="Check more products in comparision sidebar" stepKey="checkMoreProductsInComparisionSidebar" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <actionGroup ref="StorefrontCheckCompareSidebarProductActionGroup" stepKey="compareConfigProductInSidebar" after="checkMoreProductsInComparisionSidebar">
            <argument name="product" value="$$createConfigProduct$$"/>
        </actionGroup>

        <!-- Check products on comparison page -->
        <actionGroup ref="StorefrontOpenAndCheckComparisionActionGroup" stepKey="compareOpenComparePage"/>
        <actionGroup ref="StorefrontCheckCompareSimpleProductActionGroup" stepKey="compareAssertSimpleProduct1InComparison">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductCompareMainSection.ProductImageByName($$createSimpleProduct1.name$$)}}" userInput="src" stepKey="compareGrabSimpleProduct1ImageSrcInComparison"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$compareGrabSimpleProduct1ImageSrcInComparison" stepKey="compareAssertSimpleProduct1ImageNotDefaultInComparison"/>
        <actionGroup ref="StorefrontCheckCompareSimpleProductActionGroup" stepKey="compareAssertSimpleProduct2InComparison">
            <argument name="product" value="$$createSimpleProduct2$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductCompareMainSection.ProductImageByName($$createSimpleProduct2.name$$)}}" userInput="src" stepKey="compareGrabSimpleProduct2ImageSrcInComparison"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$compareGrabSimpleProduct2ImageSrcInComparison" stepKey="compareAssertSimpleProduct2ImageNotDefaultInComparison"/>

        <comment userInput="Check more products on comparision page" stepKey="checkMoreProductsOnComparisionPage" />
        <!-- @TODO: MAGETWO-80272 Move to Configurable -->
        <actionGroup ref="StorefrontCheckCompareConfigurableProductActionGroup" stepKey="compareAssertConfigProductInComparison" after="checkMoreProductsOnComparisionPage">
            <argument name="product" value="$$createConfigProduct$$"/>
            <argument name="optionProduct" value="$$createConfigChildProduct1$$"/>
        </actionGroup>
        <!-- @TODO: Move Image check to action group after MQE-697 is fixed -->
        <grabAttributeFrom selector="{{StorefrontProductCompareMainSection.ProductImageByName($$createConfigProduct.name$$)}}" userInput="src" stepKey="compareGrabConfigProductImageSrcInComparison" after="compareAssertConfigProductInComparison"/>
        <assertNotRegExp expected="'/placeholder\/small_image\.jpg/'" actual="$compareGrabConfigProductImageSrcInComparison" stepKey="compareAssertConfigProductImageNotDefaultInComparison" after="compareGrabConfigProductImageSrcInComparison"/>

        <!-- Clear comparison sidebar -->
        <click selector="{{StorefrontHeaderSection.NavigationCategoryByName($$createCategory.name$$)}}" stepKey="compareClickCategoryBeforeClear"/>
        <actionGroup ref="StorefrontCheckCategoryActionGroup" stepKey="compareAssertCategory2">
            <argument name="category" value="$$createCategory$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="productCount" value="CONST.three"/>
        </actionGroup>
        <actionGroup ref="StorefrontClearCompareActionGroup" stepKey="compareClearCompare"/>

        <!-- @TODO: MAGETWO-80272 Move to SalesRule -->
        <!-- Step 5: User uses coupon codes -->
        <actionGroup ref="StorefrontOpenCartFromMinicartActionGroup" stepKey="couponOpenCart"/>

        <actionGroup ref="StorefrontApplyCouponActionGroup" stepKey="couponApplyCoupon">
            <argument name="coupon" value="$$createSalesRuleCoupon$$"/>
        </actionGroup>

        <actionGroup ref="StorefrontCheckCouponAppliedActionGroup" stepKey="couponCheckAppliedDiscount">
            <argument name="rule" value="$$createSalesRule$$"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="discount" value="E2EB2CQuoteWith10PercentDiscount.discount"/>
        </actionGroup>
        <actionGroup ref="StorefrontCheckCartActionGroup" stepKey="couponCheckCartWithDiscount">
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="subtotal" value="E2EB2CQuoteWith10PercentDiscount.subtotal"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="shipping" value="E2EB2CQuoteWith10PercentDiscount.shipping"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="shippingMethod" value="E2EB2CQuoteWith10PercentDiscount.shippingMethod"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="total" value="E2EB2CQuoteWith10PercentDiscount.total"/>
        </actionGroup>

        <actionGroup ref="StorefrontCancelCouponActionGroup" stepKey="couponCancelCoupon"/>
        <actionGroup ref="StorefrontCheckCartActionGroup" stepKey="cartAssertCartAfterCancelCoupon">
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="subtotal" value="E2EB2CQuote.subtotal"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="shipping" value="E2EB2CQuote.shipping"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="shippingMethod" value="E2EB2CQuote.shippingMethod"/>
            <!-- @TODO: Change to scalar value after MQE-498 is implemented -->
            <argument name="total" value="E2EB2CQuote.total"/>
        </actionGroup>

        <!-- Check out -->
        <actionGroup ref="GuestCheckoutWithCheckMoneyOrderPaymentActionGroup" stepKey="guestCheckoutWithCheckMoneyOrderPayment">
            <argument name="product" value="$$createSimpleProduct1$$"/>
        </actionGroup>
    </test>
</tests>
