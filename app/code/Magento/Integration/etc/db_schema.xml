<?xml version="1.0"?>
<schema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="urn:magento:setup:Model/Declaration/Schema/etc/schema.xsd">
  <table name="oauth_consumer" resource="default" engine="innodb">
    <column xsi:type="int" name="entity_id" padding="10" unsigned="true" nullable="false" identity="true"/>
    <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
    <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="true" default="0"/>
    <column xsi:type="varchar" name="name" nullable="false" length="255"/>
    <column xsi:type="varchar" name="key" nullable="false" length="32"/>
    <column xsi:type="varchar" name="secret" nullable="false" length="32"/>
    <column xsi:type="text" name="callback_url" nullable="true"/>
    <column xsi:type="text" name="rejected_callback_url" nullable="false"/>
    <constraint xsi:type="primary" name="PRIMARY">
      <column name="entity_id"/>
    </constraint>
    <constraint xsi:type="unique" name="OAUTH_CONSUMER_KEY">
      <column name="key"/>
    </constraint>
    <constraint xsi:type="unique" name="OAUTH_CONSUMER_SECRET">
      <column name="secret"/>
    </constraint>
    <index name="OAUTH_CONSUMER_CREATED_AT" indexType="btree">
      <column name="created_at"/>
    </index>
    <index name="OAUTH_CONSUMER_UPDATED_AT" indexType="btree">
      <column name="updated_at"/>
    </index>
  </table>
  <table name="oauth_token" resource="default" engine="innodb">
    <column xsi:type="int" name="entity_id" padding="10" unsigned="true" nullable="false" identity="true"/>
    <column xsi:type="int" name="consumer_id" padding="10" unsigned="true" nullable="true" identity="false"/>
    <column xsi:type="int" name="admin_id" padding="10" unsigned="true" nullable="true" identity="false"/>
    <column xsi:type="int" name="customer_id" padding="10" unsigned="true" nullable="true" identity="false"/>
    <column xsi:type="varchar" name="type" nullable="false" length="16"/>
    <column xsi:type="varchar" name="token" nullable="false" length="32"/>
    <column xsi:type="varchar" name="secret" nullable="false" length="32"/>
    <column xsi:type="varchar" name="verifier" nullable="true" length="32"/>
    <column xsi:type="text" name="callback_url" nullable="false"/>
    <column xsi:type="smallint" name="revoked" padding="5" unsigned="true" nullable="false" identity="false" default="0"/>
    <column xsi:type="smallint" name="authorized" padding="5" unsigned="true" nullable="false" identity="false" default="0"/>
    <column xsi:type="int" name="user_type" padding="11" unsigned="false" nullable="true" identity="false"/>
    <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
    <constraint xsi:type="primary" name="PRIMARY">
      <column name="entity_id"/>
    </constraint>
    <constraint xsi:type="foreign" name="OAUTH_TOKEN_ADMIN_ID_ADMIN_USER_USER_ID" table="oauth_token" column="admin_id" referenceTable="admin_user" referenceColumn="user_id" onDelete="CASCADE"/>
    <constraint xsi:type="foreign" name="OAUTH_TOKEN_CONSUMER_ID_OAUTH_CONSUMER_ENTITY_ID" table="oauth_token" column="consumer_id" referenceTable="oauth_consumer" referenceColumn="entity_id" onDelete="CASCADE"/>
    <constraint xsi:type="foreign" name="OAUTH_TOKEN_CUSTOMER_ID_CUSTOMER_ENTITY_ENTITY_ID" table="oauth_token" column="customer_id" referenceTable="customer_entity" referenceColumn="entity_id" onDelete="CASCADE"/>
    <constraint xsi:type="unique" name="OAUTH_TOKEN_TOKEN">
      <column name="token"/>
    </constraint>
    <index name="OAUTH_TOKEN_CONSUMER_ID" indexType="btree">
      <column name="consumer_id"/>
    </index>
  </table>
  <table name="oauth_nonce" resource="default" engine="innodb">
    <column xsi:type="varchar" name="nonce" nullable="false" length="32"/>
    <column xsi:type="int" name="timestamp" padding="10" unsigned="true" nullable="false" identity="false"/>
    <column xsi:type="int" name="consumer_id" padding="10" unsigned="true" nullable="false" identity="false"/>
    <constraint xsi:type="foreign" name="OAUTH_NONCE_CONSUMER_ID_OAUTH_CONSUMER_ENTITY_ID" table="oauth_nonce" column="consumer_id" referenceTable="oauth_consumer" referenceColumn="entity_id" onDelete="CASCADE"/>
    <constraint xsi:type="unique" name="OAUTH_NONCE_NONCE_CONSUMER_ID">
      <column name="nonce"/>
      <column name="consumer_id"/>
    </constraint>
  </table>
  <table name="integration" resource="default" engine="innodb">
    <column xsi:type="int" name="integration_id" padding="10" unsigned="true" nullable="false" identity="true"/>
    <column xsi:type="varchar" name="name" nullable="false" length="255"/>
    <column xsi:type="varchar" name="email" nullable="false" length="255"/>
    <column xsi:type="varchar" name="endpoint" nullable="true" length="255"/>
    <column xsi:type="smallint" name="status" padding="5" unsigned="true" nullable="false" identity="false"/>
    <column xsi:type="int" name="consumer_id" padding="10" unsigned="true" nullable="true" identity="false"/>
    <column xsi:type="timestamp" name="created_at" on_update="false" nullable="false" default="CURRENT_TIMESTAMP"/>
    <column xsi:type="timestamp" name="updated_at" on_update="true" nullable="false" default="0"/>
    <column xsi:type="smallint" name="setup_type" padding="5" unsigned="true" nullable="false" identity="false" default="0"/>
    <column xsi:type="varchar" name="identity_link_url" nullable="true" length="255"/>
    <constraint xsi:type="primary" name="PRIMARY">
      <column name="integration_id"/>
    </constraint>
    <constraint xsi:type="foreign" name="INTEGRATION_CONSUMER_ID_OAUTH_CONSUMER_ENTITY_ID" table="integration" column="consumer_id" referenceTable="oauth_consumer" referenceColumn="entity_id" onDelete="CASCADE"/>
    <constraint xsi:type="unique" name="INTEGRATION_NAME">
      <column name="name"/>
    </constraint>
    <constraint xsi:type="unique" name="INTEGRATION_CONSUMER_ID">
      <column name="consumer_id"/>
    </constraint>
  </table>
  <table name="oauth_token_request_log" resource="default" engine="innodb">
    <column xsi:type="int" name="log_id" padding="10" unsigned="true" nullable="false" identity="true"/>
    <column xsi:type="varchar" name="user_name" nullable="false" length="255"/>
    <column xsi:type="smallint" name="user_type" padding="5" unsigned="true" nullable="false" identity="false"/>
    <column xsi:type="smallint" name="failures_count" padding="5" unsigned="true" nullable="true" identity="false" default="0"/>
    <column xsi:type="timestamp" name="lock_expires_at" on_update="true" nullable="true" default="CURRENT_TIMESTAMP"/>
    <constraint xsi:type="primary" name="PRIMARY">
      <column name="log_id"/>
    </constraint>
    <constraint xsi:type="unique" name="OAUTH_TOKEN_REQUEST_LOG_USER_NAME_USER_TYPE">
      <column name="user_name"/>
      <column name="user_type"/>
    </constraint>
  </table>
</schema>
